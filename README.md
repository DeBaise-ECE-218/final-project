Final Project: Eco-Friendly RGB Lighting
====================================================================================

### Authors
1. Nick DeBaise
2. Will Plante

Date submitted for review: 03/09/2024

### Behavior
Reads input from user adjusted potentiometers to determine the percentage of red, green, and blue light to emit from the led strip. Reads light level via LDR sensor to determine how much dimming shoukd be applied to the led strip based on natural light. PIR sensor determines if the room is occupied, and deactivates the led strip if unoccupied. Natural light level and RGB levels displayed on LCD display.

### Modules
- arduino: Facilitates communication between the NUCLEO Board and the Arduino Micro (written from scratch)
- display: Initializes the LCD display (copied from textbook and previous projects)
- interface: Prints relevant info to the LCD display (based on textbook)
- leds: No current use (functionality is now performed by the Arduino Micro) (Arduino code is from scratch and uses Neopixel library)
- motion: Initializes and determines room occupancy (based on textbook)
- sensors: Initializes and reads RGB potentiometers and LDR sensor (written from scratch)

### Hardware
- 1 NUCLEO-F429ZI Microcontroller - Com Pin D10
- 1 Arduino Micro Microcontroller - Com Pin A4
- 1 NeoPixel RGB LED Strip - 12 (ARDUINO)
- 1 LCD Display (with potentiometer) - D0-D7, D8, D9 (NUCLEO)
- 1 PIR Motion Sensor - PG_0 (NUCLEO)
- 1 LDR Light Sensor - A0(NUCLEO) A3(ARDUINO)
- 3 Potentiometers
    - R: A3(NUCLEO) A0(ARDUINO)
    - G: A2(NUCLEO) A1(ARDUINO)
    - B: A1(NUCLEO) A2(ARDUINO)
  
### Testing
- Initial LED strip test: Ensure that LEDs can turn on and be controlled via software [pass]
- Initial LCD display test: Ensure that LCD can turn on and display values from software [pass]
- LCD display with sensor value display functionality: Ensure that LCD can display analog readings as a percentage [pass]
- RGB strip with LDR dimming functionality: Ensure that LDR appropiately dims the brightness of the LED strip [pass]
- RGB with potentiometer color change functionality: Ensure that potentiometers accurately change color of LED strip [pass]
- RGB with PIR occupancy detection functionality: Ensure that PIR sensor turns on LED strip when motion is detected, delays a few seconds before turning off the LEDs, and then allows for the motion to be retriggered.


| Specifications                                                             | Tests                                                                                                                                                                                                                                                                                                                         |
| -------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Goal #1) Detect room occupancy and turn the LED strip on/off accordingly |
| When a user “enters the room”, turn the LED strip on                       | Waving a hand in the vicinity of the LED strip will turn the LED strip on for at least 5 seconds <br>Results: [Pass] PIR sensor consistently detected motion upon initial activation (pass).                                                                                                                                  |
|                                                                            | Continually waving a hand will keep the LED strip on<br>Results: [Pass] PIR sensor constantly detects a hand moving and retriggers the state machine to go back to the occupied state without turning the LED off                                                                                                             |
| When a user “leaves the room”, turn the LED strip off                      | Removing the hand from the room will start a delay of 5 seconds before turning the LED strip off<br>Results: [Pass] After 5 seconds of no motion, the LED strip turns off                                                                                                                                                     |
|                                                                            | If during the 5 second delay a person “re enters” the room, keep the LED strip on and reset the delay timer<br>Results: [Pass] the user can reenter the room and the lights will stay on                                                                                                                                      |
|                                                                            | LED strip stays off initially and when there is no motion<br>Results: [Pass] the lights stay off with no motion                                                                                                                                                                                                               |
|                                                                            |                                                                                                                                                                                                                                                                                                                               |
| Goal #2) Adjust brightness of the LED strip via the level of natural light |                                                                                                                                                                                                                                                                                                                               |
|                                                                            |                                                                                                                                                                                                                                                                                                                               |
| Specifications                                                             | Tests                                                                                                                                                                                                                                                                                                                         |
|                                                                            | At medium levels of natural light, LED strip should be at around 50% brightness (no external lighting such as phone flashlight)<br>Results: [Pass]                                                                                                                                                                            |
| Turn brightness down when it is bright out                                 | When a phone flashlight is shined onto the LDR sensor, the brightness should dramatically decrease<br>Results: [Pass]                                                                                                                                                                                                         |
|                                                                            | Placing hands about 6 inches from the LDR sensor to cast a shadow on the sensor should visibly increase the brightness of the LEDs<br>Results: [Pass]                                                                                                                                                                         |
|                                                                            | Completely covering the LDR sensor should drastically increase the brightness of the LEDs<br>Results: [Pass]                                                                                                                                                                                                                  |
|                                                                            |                                                                                                                                                                                                                                                                                                                               |
| Goal #3) Adjust colors of the LED strip                                    |                                                                                                                                                                                                                                                                                                                               |
| Specifications                                                             | Tests                                                                                                                                                                                                                                                                                                                         |
| Allow the user to change the colors of the LED strip when it is on         | Turning all potentiometers to off and then the red potentiometer to 100% should have a complete red color<br>Results: [Incomplete Pass] Sometimes the analog readings are finicky due to bad connections between the potentiometer, breadboard, and Arduino so lights from other potentiometers may shine through as well     |
|                                                                            | Turning all potentiometers to off and then the green potentiometer to 100% should have a complete green color<br>Results: [Incomplete Pass] Sometimes the analog readings are finicky due to bad connections between the potentiometer, breadboard, and Arduino so lights from other potentiometers may shine through as well |
|                                                                            | Turning all potentiometers to off and then the blue potentiometer to 100% should have a complete blue color<br>Results: [Incomplete Pass] Sometimes the analog readings are finicky due to bad connections between the potentiometer, breadboard, and Arduino so lights from other potentiometers may shine through as well   |
|                                                                            | Turning all potentiometers to 100% should have a color close to white displayed<br>Results: [Pass]                                                                                                                                                                                                                            |
|                                                                            | Turning all potentiometers to off and then the red potentiometer to 100% and blue potentiometer to 100% should have a purplish hue<br>Results: [Pass]                                                                                                                                                                         |
|                                                                            | Turning all potentiometers to off and then the green and blue potentiometer to 100% should have a aqua/teal color<br>Results: [Pass]                                                                                                                                                                                          |
|                                                                            |                                                                                                                                                                                                                                                                                                                               |
| Goal #4) Display the RGB and light level values to the user                |                                                                                                                                                                                                                                                                                                                               |
|                                                                            |                                                                                                                                                                                                                                                                                                                               |
| Specifications                                                             | Tests                                                                                                                                                                                                                                                                                                                         |
| Display the three potentiometer colors in a percent format                 | Turning the red potentiometer to 0%, waiting 2 seconds, and then turning it to 100% should display roughly: 0 and 100 on the LCD<br>Results: [Pass]                                                                                                                                                                           |
|                                                                            | Turning the green potentiometer to 0%, waiting 2 seconds, and then turning it to 100% should display roughly: 0 and 100 on the LCD<br>Results: [Pass]                                                                                                                                                                         |
|                                                                            | Turning the blue potentiometer to 0%, waiting 2 seconds, and then turning it to 100% should display roughly: 0 and 100 on the LCD<br>Results: [Pass]                                                                                                                                                                          |
|                                                                            | Turning the red potentiometer to halfway should display: 50 on the LCD<br>Results: [Pass]                                                                                                                                                                                                                                     |
| Display the level of light that the LDR sensor is reading on the LCD       | Covering the LDR sensor should display a value close to 10 on the LCD<br>Results: [Pass]                                                                                                                                                                                                                                      |
|                                                                            | Natural light shining on the LDR sensor should display a value close to 90 on the LCD<br>Results: [Pass]                                                                                                                                                                                                                      |



### Other Important Details

The Nucleo F429ZI is based on the STM32 microcontroller. Currently, no good libraries exist to drive Neopixels on the Nucleo board. Thus, an external Arduino Micro was used to drive the Neopixels and interface with the Nucleo controller. The provided 'FinalProjectCode.ino' file should be uploaded to the Arduino in order to drive the Neopixels.
